ConsentCompliance(X, Y) -< DataSubject(Y), DataController(X), ConsentGiven(Y, X).

~ConsentGiven(Y, X) <-  ~ExplicitlyGiven(Y, X).
~ExplicitlyGiven(Y, X) <- ~ConsentStatusExplicitlyGiven(Y, X).
~ConsentStatusExplicitlyGiven(Y, X) <- ~StatusValidForProcessing(X, Y).

~StatusValidForProcessing(X, Y) <- ~ExplicitlyGiven(Y, X).
~StatusValidForProcessing(X, Y) <- ~ImplicitlyGiven(Y, X).
~ImplicitlyGiven(Y, X) <- ConsentStatusImplicitlyGiven(Y, X).
~StatusValidForProcessing(X, Y) <- ~GivenByDelegation(Y, X).
GivenByDelegation(Y, X) <- ConsentStatusGivenByDelegation(Y, X).

%Status
~ConsentCompliance(X, Y) -< ~StatusForConsent(X, Y).
StatusForConsent(X, Y) <- StatusValidForProcessing(X, Y).
~StatusForConsent(X, Y) <- StatusInvalidForProcessing(X, Y).

~StatusInvalidForProcessing(X, Y) <- ~ConsentStatusExpired(X, Y).
~StatusInvalidForProcessing(X, Y) <- ~ConsentStatusInvalidated(X, Y).
~StatusInvalidForProcessing(X, Y) <- ~ConsentStatusNotGiven(X, Y).
~StatusInvalidForProcessing(X, Y) <- ~ConsentStatusRefused(X, Y).
~StatusInvalidForProcessing(X, Y) <- ~ConsentStatusRequested(X, Y).
~StatusInvalidForProcessing(X, Y) <- ~ConsentStatusUnknown(X, Y).
~StatusInvalidForProcessing(X, Y) <- ~ConsentStatusWithdrawn(X, Y).

%Purpose
~ConsentCompliance(X, Y) -<  ~PurposeForConsent(X, Y).
~PurposeForConsent(X, Y) <- ~SpecifySpecificInstanceOfPurpose(X, Y).
~PurposeForConsent(X, Y) <- ThirdParty(Z), ~SpecifyPurposeAssociatedWithThirdParties(X, Z).

~ConsentCompliance(X, Y) -< ~ValidConsent(X, Y).
~ValidConsent(X, Y) <- ~FreelyGiven(Y, X).
~FreelyGiven(Y, X) <- ~FreelyGivenConsentObligation(X, Y). 
~ValidConsent(X, Y) <- ~Informed(X, Y).
~Informed(X, Y) <- ~InformedConsentObligation(X, Y).
~ValidConsent(X, Y) <- ~Specific(X, Y).
~Specific(X, Y) <- SpecificConsentObligation(X, Y).
~ValidConsent(X, Y) <- ~VoluntaryAndoptIn(X, Y).
~VoluntaryAndoptIn(X, Y) <- ~VoluntaryOptInConsentObligation(X, Y).


~ConsentCompliance(X, Y) -< ~ConsentActivity(X, Y), ~ObligationForObtainingConsent(X, Y).
ConsentActivity(X, Y) <- ObtainingConsentFromDataSubject(X, Y).
ConsentActivity(X, Y) <- WithdrawingGivenConsent(Y, X). 

%PersonalData
~ConsentCompliance(X, Y) -< ~PersonalDataForConsent(Y, X).
PersonalDataForConsent(Y, X) <- PersonalData(Y). 

~ObligationForObtainingConsent(X, Y) <- ~CanBeWithdrawnEasilyConsentObligation(Y, X).
~ObligationForObtainingConsent(X, Y) <- ~ClearExplanationOfProcessingConsentObligation(X, Y).
~ObligationForObtainingConsent(X, Y) <- ~ShouldBeDemonstrable(X, Y).
~ObligationForObtainingConsent(X, Y) <- ~ShouldBeDistinguishableFromOtherMatters(X, Y).
~ObligationForObtainingConsent(X, Y) <- ~NotFromSilenceOrInactivityConsentObligation(X, Y).
~ObligationForObtainingConsent(X, Y) <- ~ValidConsent(X, Y).

% ConsentForProcessingPersonalData
~ConsentCompliance(X, Y) -< ~ConsentForProcessingPersonalData(X, Y).
~ConsentForProcessingPersonalData(X, Y) <- ~ConsentForDataAdaptation(X, Y).
~ConsentForProcessingPersonalData(X, Y) <- ~ConsentForDataAlignment(X, Y).
~ConsentForProcessingPersonalData(X, Y) <- ~ConsentForDataAlteration(X, Y).
~ConsentForProcessingPersonalData(X, Y) <- ~ConsentForDataCollection(X, Y).
~ConsentForProcessingPersonalData(X, Y) <- ~ConsentForDataCombination(X, Y).
~ConsentForProcessingPersonalData(X, Y) <- ~ConsentForDataConsultation(X, Y).
~ConsentForProcessingPersonalData(X, Y) <- ~ConsentForDataDestruction(X, Y).
~ConsentForProcessingPersonalData(X, Y) <- ~ConsentForDataDisclosurebyTransmission(X, Y).
~ConsentForProcessingPersonalData(X, Y) <- ~ConsentForDataErasure(X, Y).
~ConsentForProcessingPersonalData(X, Y) <- ~ConsentForDataRecording(X, Y).
~ConsentForProcessingPersonalData(X, Y) <- ~ConsentForDataRestriction(X, Y).
~ConsentForProcessingPersonalData(X, Y) <- ~ConsentForDataRetrieval(X, Y).
~ConsentForProcessingPersonalData(X, Y) <- ~DataSharingConsent(X, Y).
~ConsentForProcessingPersonalData(X, Y) <- ~ConsentForDataStorage(X, Y).
~ConsentForProcessingPersonalData(X, Y) <- ~ConsentForDataStructuring(X, Y).
~ConsentForProcessingPersonalData(X, Y) <- ThirdParty(Z), ~SpecifyRoleOfThirdPartiesForProcessingData(X, Z).


% ConsentContext
~ConsentCompliance(X, Y) -< ~ContextForConsent(X, Y).
~ContextForConsent(X, Y) <- ~SpecifyConsentLocation(X, Y).
~ContextForConsent(X, Y) <- ~SpecifyConsentMedium(X, Y).
~ContextForConsent(X, Y) <- ~SpecifyConsentTime(X, Y).
~ContextForConsent(X, Y) <- ~SpecifyConsentExpiry(X, Y).
%rules
ConsentCompliance(X,Y) -< InformedConsentObligation(X, Y), ConsentForDataUse(X, Y).
~ConsentCompliance(X,Y) -< ~InformedConsentObligation(X, Y), ~DataSharingConsent(X, Y).
ConsentCompliance(X,Y) -< ConsentStatusExplicitlyGiven(Y, X), DataSharingConsent(X,Y).

%Facts
DataSubject(user).
DataController(grindr).
%~ConsentGiven(user, grindr).                          %ForQueryResult YES
%~FreelyGivenConsentObligation(user, grindr).         %ForQueryResult NO
%InformedConsentObligation(grindr, user).              %missingInfo
%DataSharingConsent(grindr, user).                     %missingInfo
%~WithdrawingGivenConsent(user, grindr).               %threatmitigation
~ConsentActivity(grindr,user).
























